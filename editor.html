<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0"><meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate"><meta http-equiv="Pragma" content="no-cache"><meta http-equiv="Expires" content="0"><title>PHARAOH™ Collection Editor</title><link rel="icon" type="image/png" href="https://i.ibb.co/C36djqWp/Pharaoh-1.png"><style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:linear-gradient(135deg,rgba(250,245,255,.6),rgba(255,250,245,.6));color:#1a1a1a;line-height:1.6;padding:2rem;min-height:100vh}header{text-align:center;margin-bottom:2rem;padding-bottom:1.5rem;border-bottom:1px solid rgba(0,0,0,.1)}header h1{font-size:2.2rem;font-weight:200;letter-spacing:.4em;text-transform:uppercase;margin-bottom:.8rem}header p{font-size:.85rem;color:#666;letter-spacing:.15em;text-transform:uppercase}.notice{background:rgba(255,200,0,.08);border-left:3px solid #ffc800;padding:1.2rem 1.8rem;margin-bottom:2rem;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,.03)}.notice strong{color:#c90;font-weight:500}.stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem;margin-bottom:2rem}.stat-card{background:rgba(255,255,255,.9);border:1px solid rgba(0,0,0,.08);border-radius:8px;padding:1.5rem;text-align:center}.stat-value{font-size:2rem;font-weight:300;color:#1a1a1a;margin-bottom:.5rem}.stat-label{font-size:.75rem;text-transform:uppercase;letter-spacing:.15em;color:#666}.container{max-width:1400px;margin:0 auto}.grid{display:grid;grid-template-columns:1fr 1fr;gap:2rem;margin-bottom:2rem}@media(max-width:1024px){.grid{grid-template-columns:1fr}}section{background:rgba(255,255,255,.7);backdrop-filter:blur(10px);padding:2rem;border-radius:12px;box-shadow:0 2px 12px rgba(0,0,0,.06);border:1px solid rgba(0,0,0,.06);transition:all .3s}section:hover{box-shadow:0 4px 20px rgba(0,0,0,.08)}section h2{font-size:1.2rem;font-weight:400;letter-spacing:.25em;text-transform:uppercase;margin-bottom:1.8rem;color:#1a1a1a;padding-bottom:.8rem;border-bottom:2px solid #1a1a1a}.section-actions{display:flex;gap:1rem;margin-bottom:1.5rem;flex-wrap:wrap}.btn{padding:.8rem 1.8rem;font-size:.7rem;letter-spacing:.18em;text-transform:uppercase;border:1px solid #1a1a1a;background:#1a1a1a;color:#fff;cursor:pointer;transition:all .3s;font-weight:500;border-radius:8px;font-family:inherit;display:inline-flex;align-items:center;gap:.5rem}.btn:hover{background:#2a2a2a;transform:translateY(-2px);box-shadow:0 4px 12px rgba(0,0,0,.2)}.btn-secondary{background:rgba(255,255,255,.9);color:#1a1a1a;border:1px solid rgba(0,0,0,.15)}.btn-secondary:hover{background:#fff;border-color:#1a1a1a}.btn-edit{background:rgba(255,255,255,.9);color:#1a1a1a;border:1px solid rgba(0,0,0,.12);padding:.6rem 1.2rem;font-size:.68rem;letter-spacing:.15em}.btn-edit:hover{background:#1a1a1a;color:#fff;border-color:#1a1a1a}.btn-delete{background:rgba(211,47,47,.08);color:#d32f2f;border:1px solid rgba(211,47,47,.3);padding:.6rem 1.2rem;font-size:.68rem;letter-spacing:.15em}.btn-delete:hover{background:#d32f2f;color:#fff;border-color:#d32f2f}.btn-bulk{background:rgba(76,175,80,.1);color:#4CAF50;border:1px solid rgba(76,175,80,.3)}.btn-bulk:hover{background:#4CAF50;color:#fff}.search-box{flex:1;min-width:200px;padding:.85rem 1rem;font-size:.85rem;border:1px solid rgba(0,0,0,.12);border-radius:6px;font-family:inherit;background:rgba(255,255,255,.8)}.search-box:focus{outline:0;border-color:#1a1a1a;box-shadow:0 0 0 3px rgba(0,0,0,.05)}.sort-select{padding:.85rem 1rem;font-size:.85rem;border:1px solid rgba(0,0,0,.12);border-radius:6px;font-family:inherit;background:rgba(255,255,255,.8);cursor:pointer}.form-group{margin-bottom:1.3rem}.form-group label{display:block;font-size:.7rem;letter-spacing:.15em;text-transform:uppercase;margin-bottom:.6rem;font-weight:500;color:#666}.form-group input,.form-group select{width:100%;padding:.85rem 1rem;font-size:.9rem;border:1px solid rgba(0,0,0,.12);border-radius:6px;font-family:inherit;background:rgba(255,255,255,.8);transition:all .3s}.form-group input:focus,.form-group select:focus{outline:0;border-color:#1a1a1a;background:#fff;box-shadow:0 0 0 3px rgba(0,0,0,.05)}.form-group input[readonly]{background:rgba(250,250,250,.9);color:#666;cursor:not-allowed}.form-note{font-size:.75rem;color:#888;margin-top:.4rem;font-style:italic}.validation-warning{background:rgba(255,152,0,.1);border-left:3px solid #ff9800;padding:.8rem;margin-top:.5rem;font-size:.8rem;color:#e65100;border-radius:4px}.item-list{display:flex;flex-direction:column;gap:1rem}.item{background:rgba(255,255,255,.9);backdrop-filter:blur(10px);padding:1.2rem;border-radius:8px;border:1px solid rgba(0,0,0,.08);display:flex;justify-content:space-between;align-items:center;transition:all .3s;gap:1rem}.item:hover{box-shadow:0 4px 12px rgba(0,0,0,.08);transform:translateY(-1px)}.item.selected{border-color:#4CAF50;background:rgba(76,175,80,.05)}.item-checkbox{width:18px;height:18px;cursor:pointer;flex-shrink:0}.item-thumb{width:60px;height:60px;border-radius:6px;object-fit:cover;flex-shrink:0;border:1px solid rgba(0,0,0,.1)}.item-info{flex:1;min-width:0}.item-name{font-weight:500;font-size:.95rem;letter-spacing:.1em;margin-bottom:.4rem;color:#1a1a1a}.item-name-edit{width:100%;padding:.4rem;font-size:.9rem;border:1px solid #4CAF50;border-radius:4px;font-family:inherit}.item-details{font-size:.8rem;color:#666;letter-spacing:.05em}.item-actions{display:flex;gap:.8rem;flex-shrink:0;flex-wrap:wrap}.color-inputs{display:flex;flex-direction:column;gap:1rem}.color-input{display:flex;gap:.8rem;align-items:center;background:rgba(250,250,250,.5);padding:.8rem;border-radius:6px;border:1px solid rgba(0,0,0,.06)}.color-input select,.color-input input{flex:1}.color-input button{padding:.6rem 1rem;font-size:.68rem}.color-preview{width:30px;height:30px;border-radius:4px;border:2px solid rgba(0,0,0,.2);flex-shrink:0}.cat-color-badge{display:inline-block;width:20px;height:20px;border-radius:4px;border:1px solid rgba(0,0,0,.2);margin-right:.5rem;vertical-align:middle}.modal{position:fixed;inset:0;background:rgba(0,0,0,.85);backdrop-filter:blur(12px);z-index:1000;display:none;align-items:center;justify-content:center;animation:fadeIn .3s ease}@keyframes fadeIn{from{opacity:0}to{opacity:1}}.modal.open{display:flex}.modal-content{background:rgba(255,255,255,.98);backdrop-filter:blur(20px);padding:2.5rem;border-radius:12px;max-width:600px;width:90%;max-height:90vh;overflow-y:auto;box-shadow:0 20px 60px rgba(0,0,0,.3);animation:slideUp .4s ease}@keyframes slideUp{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}.modal-content h3{font-size:1.3rem;letter-spacing:.25em;text-transform:uppercase;margin-bottom:2rem;font-weight:300;color:#1a1a1a}.close-modal{float:right;background:0 0;border:none;font-size:1.8rem;cursor:pointer;opacity:.5;transition:opacity .3s;line-height:1}.close-modal:hover{opacity:1}.preview-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:1.2rem;margin-top:1rem}.preview-card{background:rgba(255,255,255,.9);border:1px solid rgba(0,0,0,.08);border-radius:8px;padding:1.2rem;text-align:center;transition:all .3s}.preview-card:hover{box-shadow:0 4px 15px rgba(0,0,0,.1);transform:translateY(-2px)}.preview-card img{width:100%;height:150px;object-fit:cover;border-radius:6px;margin-bottom:.8rem}.preview-card-name{font-size:.85rem;font-weight:500;letter-spacing:.12em;margin-bottom:.4rem;text-transform:uppercase}.preview-card-price{font-size:.8rem;color:#666}.code-output{background:#1a1a1a;color:#0f0;padding:2rem;border-radius:8px;font-family:'Courier New',monospace;font-size:.85rem;line-height:1.8;overflow-x:auto;white-space:pre;max-height:500px;overflow-y:auto;margin-top:1.5rem;position:relative;box-shadow:0 4px 20px rgba(0,0,0,.15)}.copy-btn{position:absolute;top:1.2rem;right:1.2rem;padding:.7rem 1.3rem;background:#4CAF50;color:#fff;border:none;border-radius:6px;cursor:pointer;font-size:.7rem;letter-spacing:.15em;text-transform:uppercase;transition:all .3s;font-weight:500}.copy-btn:hover{background:#45a049;transform:translateY(-2px);box-shadow:0 4px 10px rgba(76,175,80,.3)}section#colorSection .item{display:grid;grid-template-columns:auto auto 1fr auto;gap:1rem;align-items:center}.color-display{width:40px;height:40px;border-radius:6px;border:2px solid rgba(0,0,0,.15)}</style></head><body><header><h1>PHARAOH™ Collection Editor</h1><p>Live Preview & Code Generator</p></header><div class="notice"><strong>⚠️ Notice:</strong> This page does not modify the actual website. It's a testing tool to preview and generate collection.js code. Copy the generated code and manually replace your collection.js file.</div><div class="container"><div class="stats-grid" id="statsGrid"></div><div class="grid"><section><h2>Payment Settings</h2><div class="form-group"><label>Routing Number</label><input type="text" id="routingNumber"></div></section><section id="colorSection"><h2>Available Colors</h2><div class="section-actions"><button class="btn" onclick="openColorModal()">+ Add Color</button></div><div class="item-list" id="colorList"></div></section></div><div class="grid"><section><h2>Categories</h2><div class="section-actions"><button class="btn" onclick="openCategoryModal()">+ Add Category</button></div><div class="item-list" id="categoryList"></div></section><section><h2>Products</h2><div class="section-actions"><button class="btn" onclick="openProductModal()">+ Add Product</button><button class="btn-bulk btn" id="bulkEditBtn" onclick="openBulkEditModal()" style="display:none">⚡ Bulk Edit</button><input type="text" class="search-box" id="productSearch" placeholder="Search products..."><select class="sort-select" id="productSort" onchange="sortProducts()"><option value="id">Sort by ID</option><option value="name">Sort by Name</option><option value="price">Sort by Price</option><option value="category">Sort by Category</option></select></div><div style="margin-bottom:1rem"><label style="font-size:.75rem;cursor:pointer"><input type="checkbox" id="selectAll" onchange="toggleSelectAll()" style="margin-right:.5rem">Select All</label></div><div class="item-list" id="productList"></div></section></div><section><h2>Live Preview</h2><div class="preview-grid" id="previewGrid"></div></section><section><h2>Generated Code</h2><button class="btn" onclick="generateCode()">Generate collection.js Code</button><div class="code-output" id="codeOutput" style="display:none"><button class="copy-btn" onclick="copyCode()">Copy Code</button><code id="generatedCode"></code></div></section></div><div class="modal" id="colorModal"><div class="modal-content"><button class="close-modal" onclick="closeColorModal()">&times;</button><h3 id="colorModalTitle">Add Color</h3><div class="form-group"><label>Color Name</label><input type="text" id="colorName" placeholder="e.g., rose"></div><div class="form-group"><label>Hex Code</label><input type="text" id="colorHex" placeholder="e.g., #ff66cc"></div><div id="colorValidation"></div><button class="btn" onclick="saveColor()">Save Color</button></div></div><div class="modal" id="categoryModal"><div class="modal-content"><button class="close-modal" onclick="closeCategoryModal()">&times;</button><h3 id="categoryModalTitle">Add Category</h3><div class="form-group"><label>Category ID</label><input type="number" id="catId" min="1"></div><div class="form-group"><label>Category Name</label><input type="text" id="catName"></div><div class="form-group"><label>Category Color (optional)</label><input type="color" id="catColor" value="#1a1a1a"></div><div id="categoryValidation"></div><button class="btn" onclick="saveCategory()">Save Category</button></div></div><div class="modal" id="productModal"><div class="modal-content"><button class="close-modal" onclick="closeProductModal()">&times;</button><h3 id="productModalTitle">Add Product</h3><div class="form-group"><label>Product ID</label><input type="number" id="prodId" min="1" readonly><div class="form-note">Auto-generated (latest ID + 1). You can edit if needed.</div></div><div class="form-group"><label>Product Name</label><input type="text" id="prodName"><div class="form-note">Quotes (") are not allowed in product names</div></div><div class="form-group"><label>Price</label><input type="number" id="prodPrice" min="0"></div><div class="form-group"><label>Discount Price (optional)</label><input type="number" id="prodDiscount" min="0" placeholder="Leave empty if no discount"></div><div class="form-group"><label>Gender</label><select id="prodGender"><option value="male">Male</option><option value="female">Female</option><option value="unisex">Unisex</option></select></div><div class="form-group"><label>Category</label><select id="prodCategory"></select></div><div class="form-group"><label>Colors & Images</label><div class="color-inputs" id="colorInputs"></div><button class="btn-secondary" onclick="addColorInput()">+ Add Color</button></div><div id="productValidation"></div><button class="btn" onclick="saveProduct()">Save Product</button></div></div><div class="modal" id="bulkEditModal"><div class="modal-content"><button class="close-modal" onclick="closeBulkEditModal()">&times;</button><h3>Bulk Edit Products</h3><p style="margin-bottom:1.5rem;font-size:.85rem;color:#666"><span id="bulkSelectedCount">0</span> products selected</p><div class="form-group"><label>Price Adjustment</label><select id="bulkPriceAction"><option value="">No Change</option><option value="set">Set to specific value</option><option value="increase">Increase by %</option><option value="decrease">Decrease by %</option></select><input type="number" id="bulkPriceValue" min="0" placeholder="Value" style="margin-top:.5rem"></div><div class="form-group"><label>Category</label><select id="bulkCategory"><option value="">No Change</option></select></div><div class="form-group"><label>Gender</label><select id="bulkGender"><option value="">No Change</option><option value="male">Male</option><option value="female">Female</option><option value="unisex">Unisex</option></select></div><button class="btn" onclick="applyBulkEdit()">Apply Changes</button></div></div><script>document.write('<script src="collection.js?v='+Date.now()+'"><\/script>');</script><script>let data={routingNumber:'',categories:[],products:[],colors:{}},editingCategoryId=null,editingProductId=null,editingColorName=null,selectedProducts=new Set(),productSearchTerm='',productSortBy='id';function loadData(){if(typeof collection!=='undefined'){data.routingNumber=collection.routingNumber||'';data.categories=JSON.parse(JSON.stringify(collection.categories||[])).map(c=>({...c,color:c.color||'#1a1a1a'}));data.products=JSON.parse(JSON.stringify(collection.products||[]))}else{alert('Error: collection.js not found');data={routingNumber:'1234567890',categories:[],products:[],colors:{}}}if(typeof colorHex!=='undefined'){data.colors=JSON.parse(JSON.stringify(colorHex))}else{data.colors={white:'#ffffff',gold:'#ffd700',silver:'#c0c0c0',bronze:'#cd7f32',blue:'#0f52ba',pink:'#ffc0cb',black:'#000000',green:'#50c878',rose:'#ff66cc',platinum:'#e5e4e2'}}render()}function updateStats(){const total=data.products.length,avgPrice=total>0?Math.round(data.products.reduce((s,p)=>s+p.price,0)/total):0,catCounts={};data.categories.forEach(c=>catCounts[c.name]=data.products.filter(p=>p.categoryId===c.id).length);const statsHtml=`<div class="stat-card"><div class="stat-value">${total}</div><div class="stat-label">Total Products</div></div><div class="stat-card"><div class="stat-value">$${avgPrice.toLocaleString()}</div><div class="stat-label">Average Price</div></div><div class="stat-card"><div class="stat-value">${data.categories.length}</div><div class="stat-label">Categories</div></div><div class="stat-card"><div class="stat-value">${Object.keys(data.colors).length}</div><div class="stat-label">Colors</div></div>`;document.getElementById('statsGrid').innerHTML=statsHtml}function render(){document.getElementById('routingNumber').value=data.routingNumber;renderColors();renderCategories();renderProducts();renderPreview();updateCategorySelect();updateStats()}function renderColors(){const l=document.getElementById('colorList');l.innerHTML=Object.entries(data.colors).map(([n,h])=>`<div class="item"><div class="color-display" style="background:${h}"></div><div class="item-info"><div class="item-name">${n}</div><div class="item-details">${h}</div></div><div class="item-actions"><button class="btn-edit" onclick="editColor('${n}')">✏️ Edit</button><button class="btn-delete" onclick="deleteColor('${n}')">🗑️ Delete</button></div></div>`).join('')}function renderCategories(){const l=document.getElementById('categoryList');l.innerHTML=data.categories.map(c=>`<div class="item"><span class="cat-color-badge" style="background:${c.color||'#1a1a1a'}"></span><div class="item-info"><div class="item-name">ID: ${c.id}</div><div class="item-details">${c.name}</div></div><div class="item-actions"><button class="btn-edit" onclick="editCategory(${c.id})">✏️ Edit</button><button class="btn-delete" onclick="deleteCategory(${c.id})">🗑️ Delete</button></div></div>`).join('')}function getFilteredProducts(){let prods=data.products.filter(p=>p.name.toLowerCase().includes(productSearchTerm.toLowerCase()));if(productSortBy==='name')prods.sort((a,b)=>a.name.localeCompare(b.name));else if(productSortBy==='price')prods.sort((a,b)=>a.price-b.price);else if(productSortBy==='category')prods.sort((a,b)=>a.categoryId-b.categoryId);else prods.sort((a,b)=>a.id-b.id);return prods}function renderProducts(){const l=document.getElementById('productList'),prods=getFilteredProducts();l.innerHTML=prods.map(p=>{const cat=data.categories.find(c=>c.id===p.categoryId),thumb=Object.values(p.colors)[0]||'',isSelected=selectedProducts.has(p.id);return`<div class="item ${isSelected?'selected':''}"><input type="checkbox" class="item-checkbox" ${isSelected?'checked':''} onchange="toggleProductSelect(${p.id})"><img src="${thumb}" class="item-thumb" onerror="this.style.display='none'"><div class="item-info"><div class="item-name" contenteditable="true" data-id="${p.id}" data-field="name" onblur="quickEdit(this)" onkeydown="if(event.key==='Enter'){event.preventDefault();this.blur()}">${p.name}</div><div class="item-details">ID: ${p.id} | <span contenteditable="true" data-id="${p.id}" data-field="price" onblur="quickEdit(this)" onkeydown="if(event.key==='Enter'){event.preventDefault();this.blur()}" style="color:#4CAF50;cursor:text">$${p.price.toLocaleString()}</span>${p.discountPrice?' → $'+p.discountPrice.toLocaleString():''} | ${p.gender} | ${cat?'<span class="cat-color-badge" style="background:'+(cat.color||'#1a1a1a')+'"></span>'+cat.name:'Unknown'} | Colors: ${Object.keys(p.colors).length}</div></div><div class="item-actions"><button class="btn-edit" onclick="editProduct(${p.id})">✏️ Edit</button><button class="btn-delete" onclick="deleteProduct(${p.id})">🗑️ Delete</button></div></div>`}).join('');document.getElementById('bulkEditBtn').style.display=selectedProducts.size>0?'inline-flex':'none'}function quickEdit(el){const id=parseInt(el.dataset.id),field=el.dataset.field,val=el.textContent.trim(),prod=data.products.find(p=>p.id===id);if(!prod)return;if(field==='name'){const clean=val.replace(/"/g,'');if(clean!==val){alert('Quotes are not allowed in product names');el.textContent=prod.name;return}prod.name=clean}else if(field==='price'){const num=parseInt(val.replace(/[$,]/g,''));if(!isNaN(num)&&num>=0)prod.price=num;else{alert('Invalid price');el.textContent='$'+prod.price.toLocaleString();return}}render()}function toggleProductSelect(id){if(selectedProducts.has(id))selectedProducts.delete(id);else selectedProducts.add(id);renderProducts()}function toggleSelectAll(){const all=document.getElementById('selectAll').checked;if(all)getFilteredProducts().forEach(p=>selectedProducts.add(p.id));else selectedProducts.clear();renderProducts()}function sortProducts(){productSortBy=document.getElementById('productSort').value;renderProducts()}function renderPreview(){const g=document.getElementById('previewGrid');g.innerHTML=data.products.map(p=>{const f=Object.keys(p.colors)[0],cat=data.categories.find(c=>c.id===p.categoryId);return`<div class="preview-card">${cat?'<span class="cat-color-badge" style="background:'+(cat.color||'#1a1a1a')+'"></span>':''}<img src="${p.colors[f]}" alt="${p.name}"><div class="preview-card-name">${p.name}</div><div class="preview-card-price">${p.discountPrice?'<span style="text-decoration:line-through">$'+p.price.toLocaleString()+'</span> $'+p.discountPrice.toLocaleString():'$'+p.price.toLocaleString()}</div></div>`}).join('')}function updateCategorySelect(){const s=document.getElementById('prodCategory'),b=document.getElementById('bulkCategory');const opts=data.categories.map(c=>`<option value="${c.id}">${c.name}</option>`).join('');s.innerHTML=opts;b.innerHTML='<option value="">No Change</option>'+opts}function getNextProductId(){return data.products.length>0?Math.max(...data.products.map(p=>p.id))+1:1}function validateColor(name,hex){const warns=[];if(!name||!hex)warns.push('All fields are required');if(hex&&!hex.match(/^#[0-9A-Fa-f]{6}$/))warns.push('Invalid hex code. Use format: #ff66cc');return warns}function validateCategory(id,name){const warns=[];if(!id||!name)warns.push('All fields are required');if(id&&editingCategoryId===null&&data.categories.find(c=>c.id===id))warns.push('Category ID already exists');return warns}function validateProduct(id,name,price,categoryId,colors){const warns=[];if(!id||!name||!price||!categoryId)warns.push('Please fill all required fields');if(name&&name.includes('"'))warns.push('Product name cannot contain quotes (")');if(id&&editingProductId===null&&data.products.find(p=>p.id===id))warns.push('Product ID already exists');if(Object.keys(colors).length===0)warns.push('At least one color is required');Object.entries(colors).forEach(([c,url])=>{if(!url.match(/^https?:\/\/.+/))warns.push(`Invalid URL for color "${c}"`)});return warns}function showValidation(elmId,warns){const el=document.getElementById(elmId);if(warns.length>0)el.innerHTML='<div class="validation-warning">⚠️ '+warns.join('<br>⚠️ ')+'</div>';else el.innerHTML=''}function openColorModal(){editingColorName=null;document.getElementById('colorModalTitle').textContent='Add Color';document.getElementById('colorName').value='';document.getElementById('colorHex').value='';document.getElementById('colorValidation').innerHTML='';document.getElementById('colorModal').classList.add('open')}function closeColorModal(){document.getElementById('colorModal').classList.remove('open')}function editColor(n){editingColorName=n;document.getElementById('colorModalTitle').textContent='Edit Color';document.getElementById('colorName').value=n;document.getElementById('colorHex').value=data.colors[n];document.getElementById('colorValidation').innerHTML='';document.getElementById('colorModal').classList.add('open')}function saveColor(){const n=document.getElementById('colorName').value.trim().toLowerCase(),h=document.getElementById('colorHex').value.trim(),warns=validateColor(n,h);showValidation('colorValidation',warns);if(warns.length>0)return;if(editingColorName&&editingColorName!==n)delete data.colors[editingColorName];data.colors[n]=h;closeColorModal();render()}function deleteColor(n){if(confirm('Delete this color?')){delete data.colors[n];render()}}function openCategoryModal(){editingCategoryId=null;document.getElementById('categoryModalTitle').textContent='Add Category';document.getElementById('catId').value='';document.getElementById('catName').value='';document.getElementById('catColor').value='#1a1a1a';document.getElementById('categoryValidation').innerHTML='';document.getElementById('categoryModal').classList.add('open')}function closeCategoryModal(){document.getElementById('categoryModal').classList.remove('open')}function editCategory(id){editingCategoryId=id;const c=data.categories.find(x=>x.id===id);document.getElementById('categoryModalTitle').textContent='Edit Category';document.getElementById('catId').value=c.id;document.getElementById('catName').value=c.name;document.getElementById('catColor').value=c.color||'#1a1a1a';document.getElementById('categoryValidation').innerHTML='';document.getElementById('categoryModal').classList.add('open')}function saveCategory(){const id=parseInt(document.getElementById('catId').value),name=document.getElementById('catName').value,color=document.getElementById('catColor').value,warns=validateCategory(id,name);showValidation('categoryValidation',warns);if(warns.length>0)return;if(editingCategoryId!==null){const i=data.categories.findIndex(x=>x.id===editingCategoryId);data.categories[i]={id,name,color}}else{data.categories.push({id,name,color})}closeCategoryModal();render()}function deleteCategory(id){if(confirm('Delete this category?')){data.categories=data.categories.filter(x=>x.id!==id);render()}}function createColorInput(selColor='',url=''){const colorOpts=Object.keys(data.colors).map(c=>`<option value="${c}" ${c===selColor?'selected':''}>${c}</option>`).join('');return`<div class="color-input"><div class="color-preview" style="background:${data.colors[selColor]||'#fff'}"></div><select class="color-select" onchange="updateColorPreview(this)">${colorOpts}</select><input type="text" placeholder="Image URL" class="color-url" value="${url}"><button class="btn-delete" onclick="removeColorInput(this)">Remove</button></div>`}function updateColorPreview(sel){const prev=sel.parentElement.querySelector('.color-preview');prev.style.background=data.colors[sel.value]||'#fff'}function openProductModal(){editingProductId=null;document.getElementById('productModalTitle').textContent='Add Product';const nextId=getNextProductId();document.getElementById('prodId').value=nextId;document.getElementById('prodId').readOnly=false;document.getElementById('prodName').value='';document.getElementById('prodPrice').value='';document.getElementById('prodDiscount').value='';document.getElementById('prodGender').value='female';updateCategorySelect();const c=document.getElementById('colorInputs');c.innerHTML=createColorInput();document.getElementById('productValidation').innerHTML='';document.getElementById('productModal').classList.add('open')}function closeProductModal(){document.getElementById('productModal').classList.remove('open')}function editProduct(id){editingProductId=id;const p=data.products.find(x=>x.id===id);document.getElementById('productModalTitle').textContent='Edit Product';document.getElementById('prodId').value=p.id;document.getElementById('prodId').readOnly=true;document.getElementById('prodName').value=p.name;document.getElementById('prodPrice').value=p.price;document.getElementById('prodDiscount').value=p.discountPrice||'';document.getElementById('prodGender').value=p.gender;updateCategorySelect();document.getElementById('prodCategory').value=p.categoryId;const c=document.getElementById('colorInputs');c.innerHTML=Object.entries(p.colors).map(([k,v])=>createColorInput(k,v)).join('');document.getElementById('productValidation').innerHTML='';document.getElementById('productModal').classList.add('open')}function saveProduct(){const id=parseInt(document.getElementById('prodId').value),name=document.getElementById('prodName').value.replace(/"/g,''),price=parseInt(document.getElementById('prodPrice').value),discount=document.getElementById('prodDiscount').value,gender=document.getElementById('prodGender').value,categoryId=parseInt(document.getElementById('prodCategory').value),ci=document.querySelectorAll('.color-input'),colors={};ci.forEach(c=>{const n=c.querySelector('.color-select').value,u=c.querySelector('.color-url').value.trim();if(n&&u)colors[n]=u});const warns=validateProduct(id,name,price,categoryId,colors);showValidation('productValidation',warns);if(warns.length>0)return;const prod={id,name,price,gender,categoryId,colors};if(discount)prod.discountPrice=parseInt(discount);if(editingProductId!==null){const i=data.products.findIndex(x=>x.id===editingProductId);data.products[i]=prod}else{data.products.push(prod)}closeProductModal();render()}function deleteProduct(id){if(confirm('Delete this product?')){data.products=data.products.filter(x=>x.id!==id);selectedProducts.delete(id);render()}}function addColorInput(){const c=document.getElementById('colorInputs'),d=document.createElement('div');d.innerHTML=createColorInput();c.appendChild(d.firstElementChild)}function removeColorInput(b){if(document.querySelectorAll('.color-input').length>1)b.parentElement.remove();else alert('Must have at least one color')}function openBulkEditModal(){document.getElementById('bulkSelectedCount').textContent=selectedProducts.size;document.getElementById('bulkPriceAction').value='';document.getElementById('bulkPriceValue').value='';document.getElementById('bulkCategory').value='';document.getElementById('bulkGender').value='';updateCategorySelect();document.getElementById('bulkEditModal').classList.add('open')}function closeBulkEditModal(){document.getElementById('bulkEditModal').classList.remove('open')}function applyBulkEdit(){const priceAction=document.getElementById('bulkPriceAction').value,priceValue=parseFloat(document.getElementById('bulkPriceValue').value),category=document.getElementById('bulkCategory').value,gender=document.getElementById('bulkGender').value;selectedProducts.forEach(id=>{const p=data.products.find(x=>x.id===id);if(!p)return;if(priceAction==='set'&&priceValue>=0)p.price=priceValue;else if(priceAction==='increase'&&priceValue>0)p.price=Math.round(p.price*(1+priceValue/100));else if(priceAction==='decrease'&&priceValue>0)p.price=Math.round(p.price*(1-priceValue/100));if(category)p.categoryId=parseInt(category);if(gender)p.gender=gender});closeBulkEditModal();selectedProducts.clear();render();alert('Bulk edit applied successfully!')}function generateCode(){data.routingNumber=document.getElementById('routingNumber').value;const code=`// PHARAOH JEWELRY COLLECTION
// Easy-to-edit collection data - modify categories and products here

const collection = {
  // ============================================
  // PAYMENT INFO
  // ============================================
  routingNumber: "${data.routingNumber}",
  
  // ============================================
  // CATEGORIES
  // ============================================
  // Add or remove categories as needed
  // Each category needs: id (number), name (string), color (optional hex)
  
  categories: [
${data.categories.map(c=>`    { id: ${c.id}, name: "${c.name}", color: "${c.color||'#1a1a1a'}" }`).join(',\n')}
  ],

  // ============================================
  // PRODUCTS
  // ============================================
  // Each product needs:
  // - id: unique number
  // - name: product name
  // - price: regular price
  // - discountPrice: sale price (optional - remove if no discount)
  // - gender: "male", "female", or "unisex"
  // - categoryId: must match a category id above
  // - colors: object with color names and their image URLs
  
  products: [
${data.products.map(p=>`    {
      id: ${p.id},
      name: "${p.name}",
      price: ${p.price},${p.discountPrice?'\n      discountPrice: '+p.discountPrice+',':''}
      gender: "${p.gender}",
      categoryId: ${p.categoryId},
      colors: {
${Object.entries(p.colors).map(([k,v])=>`        ${k}: "${v}"`).join(',\n')}
      }
    }`).join(',\n')}
  ]
};

// Available color names and their hex codes
// Add new colors here if needed
const colorHex = {
${Object.entries(data.colors).map(([k,v])=>`  ${k}: '${v}'`).join(',\n')}
};`;document.getElementById('generatedCode').textContent=code;document.getElementById('codeOutput').style.display='block'}function copyCode(){const code=document.getElementById('generatedCode').textContent;navigator.clipboard.writeText(code).then(()=>alert('Code copied to clipboard!')).catch(()=>alert('Failed to copy'))}document.getElementById('routingNumber').addEventListener('input',()=>{data.routingNumber=document.getElementById('routingNumber').value});document.getElementById('productSearch').addEventListener('input',e=>{productSearchTerm=e.target.value;renderProducts()});window.addEventListener('load',loadData)</script></body></html>
